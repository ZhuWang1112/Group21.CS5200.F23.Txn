"0","df.strikes <- sqldf("""
"0","  SELECT 1 AS sid, "
"0","  1 AS fid, "
"0","  wildlife_struck AS numbirds, "
"0","  impact, "
"0","  damage,"
"0","  altitude_ft AS altitude, "
"0","  1 AS conditions,"
"0","  rid,"
"0","  sky_conditions"
"0","  FROM `df.raw`"
"0",""")"
"0",""
"0","n.strikes <- nrow(df.strikes)"
"0",""
"0","for (i in 1: n.strikes) {"
"0","  "
"0","  df.strikes$sid[i] <- i"
"0","  "
"0","  df.strikes$fid[i] <- df.flights$fid[which(df.flights$rid == df.strikes$rid[i])]"
"0","  "
"0","  if (df.strikes$damage[i] == 'Caused damage') {"
"0","    df.strikes$damageBool[i] <- 1"
"0","  } else if (df.strikes$damage[i] == 'No damage') {"
"0","    df.strikes$damageBool[i] <- 0"
"0","  }"
"0","  df.strikes$altitudeInt[i] <- as.integer(gsub("","", """", df.strikes$altitude[i]))"
"0","  df.strikes$conditions[i] <- "
"0","    df.conditions$cid[which(df.conditions$sky_condition == df.strikes$sky_conditions[i])]"
"0","  "
"0","}"
"0",""
"0","df.strikes$damageBool <- as.integer(df.strikes$damageBool)"
"0",""
"0","new.df.strikes <- sqldf("""
"0","  SELECT sid, "
"0","  fid, "
"0","  numbirds, "
"0","  impact, "
"0","  damageBool AS damage,"
"0","  altitudeInt AS altitude, "
"0","  conditions"
"0","  FROM `df.strikes`"
"0",""")"
"0",""
"0","dbWriteTable(mydb, ""strikes"", new.df.strikes, overwrite = FALSE, append = TRUE, row.names = FALSE)"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# check"
"0","#dbReadTable(mydb, 'strikes')"
